id: CVE-2021-24254

info:
  name: "College publisher Import <= 0.1 - Arbitrary File Upload"
  author: topscoder
  severity: high
  description: "The College publisher Import WordPress plugin through 0.1 does not check for the uploaded CSV file to import, allowing high privilege users to upload arbitrary files, such as PHP, leading to RCE. Due to the lack of CSRF check, the issue could also be exploited via a CSRF attack."
  reference:
    - https://wpscan.com/vulnerability/bb3e56dd-ae2e-45c2-a6c9-a59ae5fc1dc4
    - https://wordpress.org/plugins/college-publisher-import/#developers
    - https://web.archive.org/web/20210413070133/https%3A//github.com/jinhuang1102/CVE-ID-Reports/blob/master/College%20Puglisher%20Import.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2021-24254
  metadata:
    fofa-query: "wp-content/plugins/college-publisher-import/"
    google-query: inurl:"/wp-content/plugins/college-publisher-import/"
    shodan-query: 'vuln:CVE-2021-24254'
  tags: cve,wordpress,wp-plugin,college-publisher-import,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/college-publisher-import/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "college-publisher-import"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 0.1')