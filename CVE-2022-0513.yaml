id: CVE-2022-0513

info:
  name: "WP Statistics <= 13.1.4 - Unauthenticated Blind SQL Injection"
  author: topscoder
  severity: critical
  description: "The WP Statistics WordPress plugin is vulnerable to SQL Injection due to insufficient escaping and parameterization of the exclusion_reason parameter found in the ~/includes/class-wp-statistics-exclusion.php file which allows attackers without authentication to inject arbitrary SQL queries to obtain sensitive information, in versions up to and including 13.1.4. This requires the 'Record Exclusions' option to be enabled on the vulnerable site."
  reference:
    - https://www.wordfence.com/blog/2022/02/unauthenticated-sql-injection-vulnerability-patched-in-wordpress-statistics-plugin/
    - https://plugins.trac.wordpress.org/changeset/2671297/wp-statistics/trunk/includes/class-wp-statistics-hits.php
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0513
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0513
  metadata:
    fofa-query: "wp-content/plugins/wp-statistics/"
    google-query: inurl:"/wp-content/plugins/wp-statistics/"
    shodan-query: 'vuln:CVE-2022-0513'
  tags: cve,wordpress,wp-plugin,wp-statistics,critical

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-statistics/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-statistics"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 13.1.4')