id: CVE-2010-5297

info:
  name: "WordPress Core < 3.0.1 - Missing Authorization"
  author: topscoder
  severity: medium
  description: "WordPress before 3.0.1, when a Multisite installation is used, permanently retains the 'site administrators can add users' option once changed, which might allow remote authenticated administrators to bypass intended access restrictions in opportunistic circumstances via an add action after a temporary change."
  reference:
    - http://codex.wordpress.org/Changelog/3.0.1
    - http://core.trac.wordpress.org/query?status=closed&group=resolution&order=priority&milestone=3.0.1&resolution=fixed
    - https://core.trac.wordpress.org/ticket/14119
    - https://core.trac.wordpress.org/changeset/15342
    - https://wordpress.org/news/2010/07/wordpress-3-0-1/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 4.7
    cve-id: CVE-2010-5297
  metadata:
    shodan-query: 'vuln:CVE-2010-5297'
  tags: cve,wordpress,wp-core,medium

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/wp-admin/install.php"
      - "{{BaseURL}}/feed/"
      - "{{BaseURL}}/?feed=rss2" # alternative if /feed/ is blocked

    redirects: true
    max-redirects: 2
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - compare_versions(version_by_generator, '< 3.0.1')
          - compare_versions(version_by_js, '< 3.0.1')
          - compare_versions(version_by_css, '< 3.0.1')

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: version_by_generator
        group: 1
        regex:
          - '(?m)https:\/\/wordpress.org\/\?v=([0-9.]+)'

      - type: regex
        name: version_by_js
        group: 1
        regex:
          - 'wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b'

      - type: regex
        name: version_by_css
        group: 1
        regex:
          - 'install\.min\.css\?ver=((\d+\.?)+)\b'
