id: CVE-2019-17661-0c7650c6f32182c8799bd4a77464ad45

info:
  name: >
    Admin Columns PRO <= 6.4.9 - Authenticated (Subscriber+) CSV Injection
  author: topscoder
  severity: low
  description: >
    The Admin Columns Pro plugin for WordPress is vulnerable to CSV Injection via the export functionality in all versions up to, and including 6.4.9. This makes it possible for authenticated attackers, with subscriber-level access and above, to embed untrusted input into their profile that may appear in an exported CSV files. This can result in code execution when these files are downloaded and opened on a local system with a vulnerable configuration. While the CVE references the free version of the plugin, we did not find any export functionality in the free version which leads us to believe this is only present in the premium version.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/79ae6c3e-5584-448b-a5c5-0a105377b81d?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 4.4
    cve-id: CVE-2019-17661
  metadata:
    fofa-query: "wp-content/plugins/admin-columns-pro/"
    google-query: inurl:"/wp-content/plugins/admin-columns-pro/"
    shodan-query: 'vuln:CVE-2019-17661'
  tags: cve,wordpress,wp-plugin,admin-columns-pro,low

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/admin-columns-pro/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "admin-columns-pro"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 6.4.9')