id: CVE-2023-0552

info:
  name: Pie Register < 3.8.2.3 - Open Redirect
  author: r3Y3r53
  severity: medium
  description: |
    Pie Register < 3.8.2.3 does not properly validate the redirection URL when logging in and login out, leading to an Open Redirect vulnerability
  remediation: |
   Fixed in version 3.8.2.3
  reference:
    - https://wpscan.com/vulnerability/832c6155-a413-4641-849c-b98ba55e8551
    - https://nvd.nist.gov/vuln/detail/CVE-2023-0552
  classification:
    cve-id: CVE-2023-0552
  metadata:
    verified: "true"
  tags: cve,cve2023,redirect,pie,pie-register

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin?piereg_logout_url=true&redirect_to=https://oast.me"

    redirects: true
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)(?:[a-zA-Z0-9\-_\.@]*)oast\.me.*$'
