id: CVE-2016-1209

info:
  name: "Ninja Forms Contact Form 2.9.36 - 2.9.42 - Unauthenticated Arbitrary File Upload"
  author: topscoder
  severity: critical
  description: "Versions 2.9.36 to 2.9.42 of the Ninja Forms plugin contain an unauthenticated file upload vulnerability, allowing guests to upload arbitrary PHP code that can be executed in the context of the web server."
  reference:
    - https://wordpress.org/plugins/ninja-forms/#developers
    - https://wpscan.com/vulnerability/8485
    - https://ninjaforms.com/blog/important-security-update-always-hurt-ones-love/
    - https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_ninja_forms_unauthenticated_file_upload/
    - https://packetstormsecurity.com/files/137211/WordPress-Ninja-Forms-Unauthenticated-File-Upload.html
    - https://www.pritect.net/blog/ninja-forms-2-9-42-critical-security-vulnerabilities
    - https://nvd.nist.gov/vuln/detail/CVE-2016-1209
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2016-1209
  metadata:
    fofa-query: "wp-content/plugins/ninja-forms/"
    google-query: inurl:"/wp-content/plugins/ninja-forms/"
    shodan-query: 'vuln:CVE-2016-1209'
  tags: cve,wordpress,wp-plugin,ninja-forms,critical

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/ninja-forms/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "ninja-forms"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '>= 2.9.36', '<= 2.9.42')