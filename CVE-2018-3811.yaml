id: CVE-2018-3811

info:
  name: "Smart Google Code Inserter < 3.5 - Unauthenticated SQL Injection"
  author: topscoder
  severity: critical
  description: "SQL Injection vulnerability in the Oturia Smart Google Code Inserter plugin before 3.5 for WordPress allows unauthenticated attackers to execute SQL queries in the context of the web server. The saveGoogleAdWords() function in smartgooglecode.php did not use prepared statements and did not sanitize the $_POST['oId'] variable before passing it as input into the SQL query."
  reference:
    - https://wpvulndb.com/vulnerabilities/8988
    - https://wordpress.org/plugins/smart-google-code-inserter/#developers
    - https://limbenjamin.com/articles/smart-google-code-inserter-auth-bypass.html
    - https://www.exploit-db.com/exploits/43420/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-3811
  metadata:
    fofa-query: "wp-content/plugins/smart-google-code-inserter/"
    google-query: inurl:"/wp-content/plugins/smart-google-code-inserter/"
    shodan-query: 'vuln:CVE-2018-3811'
  tags: cve,wordpress,wp-plugin,smart-google-code-inserter,critical

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/smart-google-code-inserter/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "smart-google-code-inserter"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.5')