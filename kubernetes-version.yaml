id: kubernetes-version

info:
  name: Kubernetes Version Exposure
  author: raesene,idealphase
  severity: info
  description: Searches for exposed Kubernetes API servers which return version information unauthenticated. For Google Kubernetes Engine (GKE) and Amazon Elastic Kubernetes Service (EKS) this template will extract
    default patch version for you.
  reference:
    - https://cloud.google.com/kubernetes-engine/docs/release-notes
    - https://docs.aws.amazon.com/eks/latest/userguide/kubernetes-versions.html
  metadata:
    shodan-query: product:"Kubernetes" version:"1.21.5-eks-bc4871b"
  tags: tech,k8s,kubernetes,devops

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /version HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
        Accept-Encoding: gzip, deflate
        Accept: */*
        
    matchers:
      - type: word
        words:
          - "gitVersion"
          - "goVersion"
          - "platform"
<<<<<<< HEAD
        condition: and

    extractors:
      - type: json
        json:
          - '.gitVersion'
=======
        condition: and
>>>>>>> 18ddf72b (add new stuff)
