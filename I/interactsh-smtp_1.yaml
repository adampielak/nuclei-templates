id: interactsh-smtp

info:
  name: ProjectDiscovery Interact.sh SMTP - Detect
  severity: info
  author: darses
  description: |
    Detect Interact.sh SMTP service.
  metadata:
    vendor: projectdiscovery
    product: interactsh
    shodan-query:
      - product:"Interactsh SMTP Server"
  tags: detect,network,tcp,smtp,interactsh

tcp:
  - inputs:
      - data: "\r\n"
    
    host:
      - "{{Hostname}}"
    
    port: 25

    matchers:
      - type: word
        words:
          - "interactsh"
          - "STMP"

    extractors:
      - type: regex
        group: 1
        regex:
          - "220 ([^\\s]+) interactsh"
