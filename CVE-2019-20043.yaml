id: CVE-2019-20043

info:
  name: "WordPress Core < 5.3.1 - Authorization Bypass"
  author: topscoder
  severity: medium
  description: "In in wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php in WordPress 3.7 to 5.3.0, authenticated users who do not have the rights to publish a post are able to mark posts as sticky or unsticky via the REST API. For example, the contributor role does not have such rights, but this allowed them to bypass that. This has been patched in WordPress 5.3.1, along with all the previous WordPress versions from 3.7 to 5.3 via a minor release."
  reference:
    - https://wpvulndb.com/vulnerabilities/9973
    - https://wordpress.org/news/2019/12/wordpress-5-3-1-security-and-maintenance-release/
    - https://core.trac.wordpress.org/changeset/46893/trunk
    - https://github.com/WordPress/wordpress-develop/commit/1d1d5be7aa94608c04516cac4238e8c22b93c1d9
    - https://seclists.org/bugtraq/2020/Jan/8
    - https://www.debian.org/security/2020/dsa-4599
    - https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-g7rg-hchx-c2gw
    - https://www.debian.org/security/2020/dsa-4677
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2019-20043
  metadata:
    shodan-query: 'vuln:CVE-2019-20043'
  tags: cve,wordpress,wp-core,medium

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/wp-admin/install.php"
      - "{{BaseURL}}/feed/"
      - "{{BaseURL}}/?feed=rss2" # alternative if /feed/ is blocked

    redirects: true
    max-redirects: 2
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - compare_versions(version_by_generator, '>= 5.3', '<= 5.3')
          - compare_versions(version_by_js, '>= 5.3', '<= 5.3')
          - compare_versions(version_by_css, '>= 5.3', '<= 5.3')

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: version_by_generator
        group: 1
        regex:
          - '(?m)https:\/\/wordpress.org\/\?v=([0-9.]+)'

      - type: regex
        name: version_by_js
        group: 1
        regex:
          - 'wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b'

      - type: regex
        name: version_by_css
        group: 1
        regex:
          - 'install\.min\.css\?ver=((\d+\.?)+)\b'
