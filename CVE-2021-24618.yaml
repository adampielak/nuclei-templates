id: CVE-2021-24618

info:
  name: "Donate With QRCode <= 1.4.4 - Authenticated (Subscriber+) Stored Cross-Site Scripting"
  author: topscoder
  severity: medium
  description: "The Donate With QRCode WordPress plugin before 1.4.5 does not sanitise or escape its QRCode Image setting, which result into a Stored Cross-Site Scripting (XSS). Furthermore, the plugin also does not have any CSRF and capability checks in place when saving such setting, allowing any authenticated user (as low as subscriber), or unauthenticated user via a CSRF vector to update them and perform such attack."
  reference:
    - https://wpscan.com/vulnerability/d50b801a-16b5-45e9-a465-e3bb0445cb49
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-24618
  metadata:
    fofa-query: "wp-content/plugins/donate-with-qrcode/"
    google-query: inurl:"/wp-content/plugins/donate-with-qrcode/"
    shodan-query: 'vuln:CVE-2021-24618'
  tags: cve,wordpress,wp-plugin,donate-with-qrcode,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/donate-with-qrcode/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "donate-with-qrcode"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.4.4')