id: CVE-2022-2362

info:
  name: "Download Manager <= 3.2.49 - IP Blocking Bypass"
  author: topscoder
  severity: medium
  description: "The Download Manager plugin for WordPress is vulnerable to IP Blocking Bypass in versions up to, and including, 3.2.49 due to the way the visitor's IP address is determined. This allows an unauthenticated attacker to spoof their IP address to obtain access to files that are protected by this functionality."
  reference:
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2761422%40download-manager%2Ftrunk&old=2752628%40download-manager%2Ftrunk&sfp_email=&sfph_mail=
    - https://patchstack.com/database/vulnerability/download-manager-/wordpress-download-manager-plugin-3-2-49-bypass-ip-address-blocking-restriction-vulnerability
    - https://wpscan.com/vulnerability/d94b721e-9ce2-45e5-a673-2a57b0137653
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2022-2362
  metadata:
    fofa-query: "wp-content/plugins/download-manager/"
    google-query: inurl:"/wp-content/plugins/download-manager/"
    shodan-query: 'vuln:CVE-2022-2362'
  tags: cve,wordpress,wp-plugin,download-manager,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/download-manager/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "download-manager"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 3.2.49')