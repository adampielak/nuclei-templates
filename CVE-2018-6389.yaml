id: CVE-2018-6389

info:
  name: "WordPress Core <= 4.9.8 - Denial of Service"
  author: topscoder
  severity: high
  description: "In WordPress through 4.9.2, unauthenticated attackers can cause a denial of service (resource consumption) by using the large list of registered .js files (from wp-includes/script-loader.php) to construct a series of requests to load every file many times. It looks like most of the slowness was due to forcing PHP to repeatedly compress the output scripts, which was addressed in 4.9.9."
  reference:
    - http://www.securityfocus.com/bid/103060
    - https://wpvulndb.com/vulnerabilities/9021
    - https://www.exploit-db.com/exploits/43968/
    - https://baraktawily.blogspot.fr/2018/02/how-to-dos-29-of-world-wide-websites.html
    - http://www.securitytracker.com/id/1040347
    - https://thehackernews.com/2018/02/wordpress-dos-exploit.html
    - https://github.com/WazeHell/CVE-2018-6389
    - https://github.com/UltimateHackers/Shiva
    - https://core.trac.wordpress.org/changeset/43580/trunk/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2018-6389
  metadata:
    shodan-query: 'vuln:CVE-2018-6389'
  tags: cve,wordpress,wp-core,high

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/wp-admin/install.php"
      - "{{BaseURL}}/feed/"
      - "{{BaseURL}}/?feed=rss2" # alternative if /feed/ is blocked

    redirects: true
    max-redirects: 2
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - compare_versions(version_by_generator, '<= 4.9.8')
          - compare_versions(version_by_js, '<= 4.9.8')
          - compare_versions(version_by_css, '<= 4.9.8')

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: version_by_generator
        group: 1
        regex:
          - '(?m)https:\/\/wordpress.org\/\?v=([0-9.]+)'

      - type: regex
        name: version_by_js
        group: 1
        regex:
          - 'wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b'

      - type: regex
        name: version_by_css
        group: 1
        regex:
          - 'install\.min\.css\?ver=((\d+\.?)+)\b'
