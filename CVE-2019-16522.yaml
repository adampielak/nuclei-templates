id: CVE-2019-16522

info:
  name: "EU Cookie Law <= 3.1.2 - Authenticated Stored Cross-Site Scripting"
  author: topscoder
  severity: medium
  description: "The eu-cookie-law plugin through 3.0.6 for WordPress (aka EU Cookie Law (GDPR)) is susceptible to Stored XSS due to improper encoding of several configuration options in the admin area and the displayed cookie consent message. This affects Font Color, Background Color, and the Disable Cookie text. An attacker with high privileges can attack other users."
  reference:
    - https://wordpress.org/plugins/eu-cookie-law/#developers
    - https://github.com/sbaresearch/advisories/tree/public/2019/SBA-ADV-20190913-01_WordPress_Plugin_EU_Cookie_Law
    - https://wpvulndb.com/vulnerabilities/9918
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
    cve-id: CVE-2019-16522
  metadata:
    fofa-query: "wp-content/plugins/eu-cookie-law/"
    google-query: inurl:"/wp-content/plugins/eu-cookie-law/"
    shodan-query: 'vuln:CVE-2019-16522'
  tags: cve,wordpress,wp-plugin,eu-cookie-law,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/eu-cookie-law/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "eu-cookie-law"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.1.3')