id: CVE-2021-21972

info:
  name: VMware vCenter Unauthenticated RCE
  author: dwisiswant0
  severity: critical
<<<<<<< HEAD
  description: VMware vCenter vSphere Client (HTML5) contains a remote code execution vulnerability in a vCenter Server plugin. A malicious actor with network access to port 443 may exploit this issue to execute commands with unrestricted privileges on the underlying operating system that hosts vCenter Server. This affects VMware vCenter Server (7.x before 7.0 U1c, 6.7 before 6.7 U3l and 6.5 before 6.5 U3n) and VMware Cloud Foundation (4.x before 4.2 and 3.x before 3.10.1.2).
  reference:
    - https://swarm.ptsecurity.com/unauth-rce-vmware/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-21972
    - https://www.vmware.com/security/advisories/VMSA-2021-0002.html
    - http://packetstormsecurity.com/files/161590/VMware-vCenter-Server-7.0-Arbitrary-File-Upload.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-21972
    cwe-id: CWE-269
<<<<<<< HEAD
  tags: cve,cve2021,vmware,rce,vcenter,kev
=======
  tags: cve2021,vmware,rce,vcenter,kev,packetstorm,cve
>>>>>>> 5d36d276 (add new stuff)
=======
  reference: https://swarm.ptsecurity.com/unauth-rce-vmware/
  description: The vulnerability allows unauthenticated remote attackers to upload file leading to remote code execution (RCE). This templates only detects the plugin.
  tags: cve,cve2021,vmware,rce
>>>>>>> 18ddf72b (add new stuff)

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /ui/vropspluginui/rest/services/getstatus HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "VSPHERE-UI-JSESSIONID"
        part: header
        condition: and
      - type: regex
        regex:
          - "(Install|Config) Final Progress"
        part: body
