id: CVE-2009-0347

info:
  name: Autonomy Ultraseek - Open Redirect
  author: ctflearner
  severity: medium
  description: |
    Open redirect vulnerability in cs.html in the Autonomy (formerly Verity) Ultraseek search engine allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via the url parameter.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2009-0347
    - https://www.exploit-db.com/exploits/32766
    - https://www.kb.cert.org/vuls/id/202753
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/48336
  classification:
    cvss-metrics: AV:N/AC:M/Au:N/C:N/I:P/A:P
    cvss-score: 5.8
    cve-id: CVE-2009-0347
    cwe-id: CWE-59
    cpe: cpe:2.3:a:autonomy:ultraseek:_nil_:*:*:*:*:*:*:*
  tags: cve,cve2009,redirect,autonomy

http:
  - method: GET
    path:
      - "{{BaseURL}}/cs.html?url=http://www.interact.sh"

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:http?://|//)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh.*$'
