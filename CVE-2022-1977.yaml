id: CVE-2022-1977

info:
  name: "WP Ultimate CSV Importer <= 6.5.2 - Server-Side Request Forgery"
  author: topscoder
  severity: medium
  description: "The Import Export All WordPress Images, Users & Post Types WordPress plugin before 6.5.3 does not fully validate the file to be imported via an URL before making an HTTP request to it, which could allow high privilege users such as admin to perform Blind SSRF attacks"
  reference:
    - https://wpscan.com/vulnerability/1b640519-75e1-48cb-944e-b9bff9de6d3d
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2721106%40wp-ultimate-csv-importer%2Ftrunk&old=2713265%40wp-ultimate-csv-importer%2Ftrunk&sfp_email=&sfph_mail=
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N
    cvss-score: 4.1
    cve-id: CVE-2022-1977
  metadata:
    fofa-query: "wp-content/plugins/wp-ultimate-csv-importer/"
    google-query: inurl:"/wp-content/plugins/wp-ultimate-csv-importer/"
    shodan-query: 'vuln:CVE-2022-1977'
  tags: cve,wordpress,wp-plugin,wp-ultimate-csv-importer,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-ultimate-csv-importer/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-ultimate-csv-importer"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 6.5.2')