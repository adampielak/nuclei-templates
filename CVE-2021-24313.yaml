id: CVE-2021-24313

info:
  name: "WP Prayer <= 1.6.1 - Authenticated Stored Cross-Site Scripting"
  author: topscoder
  severity: medium
  description: "The WP Prayer WordPress plugin before 1.6.2 provides the functionality to store requested prayers/praises and list them on a WordPress website. These stored prayer/praise requests can be listed by using the WP Prayer engine. An authenticated WordPress user with any role can fill in the form to request a prayer. The form to request prayers or praises have several fields. The 'prayer request' and 'praise request' fields do not use proper input validation and can be used to store XSS payloads."
  reference:
    - https://wpscan.com/vulnerability/c7ab736d-27c4-4ec5-9681-a3f0dda86586
    - https://bastijnouwendijk.com/cve-2021-24313/
    - https://plugins.trac.wordpress.org/changeset/2531964/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
    cve-id: CVE-2021-24313
  metadata:
    fofa-query: "wp-content/plugins/wp-prayer/"
    google-query: inurl:"/wp-content/plugins/wp-prayer/"
    shodan-query: 'vuln:CVE-2021-24313'
  tags: cve,wordpress,wp-plugin,wp-prayer,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-prayer/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-prayer"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 1.6.2')