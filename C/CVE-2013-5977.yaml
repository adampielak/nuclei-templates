id: CVE-2013-5977

info:
  name: "Cart66 Lite :: WordPress Ecommerce < 1.5.1.15 - Cross-Site Request Forgery"
  author: topscoder
  severity: medium
  description: "Cross-site request forgery (CSRF) vulnerability in Cart66Product.php in the Cart66 Lite plugin before 1.5.1.15 for WordPress allows remote attackers to hijack the authentication of administrators for requests that (1) create or modify products or conduct cross-site scripting (XSS) attacks via the (2) Product name or (3) Price description field in a product save action via a request to wp-admin/admin.php."
  reference:
    - http://archives.neohapsis.com/archives/bugtraq/2013-10/0048.html
    - http://www.exploit-db.com/exploits/28959
    - http://osvdb.org/98352
    - http://seclists.org/bugtraq/2013/Oct/52
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/87874
    - http://secunia.com/advisories/55265
    - http://wordpress.org/plugins/cart66-lite/changelog/
    - http://blog.noobroot.com/#!/2013/10/0-day-wordpress-cart66-plugin-15114.html
    - http://www.securityfocus.com/bid/62975
    - http://packetstormsecurity.com/files/123587/WordPress-Cart66-1.5.1.14-Cross-Site-Request-Forgery-Cross-Site-Scripting.html
    - https://plugins.trac.wordpress.org/changeset/786501
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
    cvss-score: 6.3
    cve-id: CVE-2013-5977
  metadata:
    fofa-query: "wp-content/plugins/cart66-lite/"
    google-query: inurl:"/wp-content/plugins/cart66-lite/"
    shodan-query: 'vuln:CVE-2013-5977'
  tags: cve,wordpress,wp-plugin,cart66-lite,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/cart66-lite/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "cart66-lite"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 1.5.1.15')