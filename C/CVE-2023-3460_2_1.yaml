id: CVE-2023-3460

info:
  name: WordPress Ultimate Member Plugin <2.6.7 - Privilege Escalation
  author: sh-kynd
  severity: critical
  description: The Ultimate Member WordPress plugin before 2.6.7 does not prevent visitors from creating user accounts with arbitrary capabilities, effectively allowing attackers to create administrator accounts at will. This is actively being exploited in the wild.
  reference:
    - https://blog.wpscan.com/hacking-campaign-actively-exploiting-ultimate-member-plugin/
    - https://wpscan.com/vulnerability/694235c7-4469-4ffd-a722-9225b19e98d7
    - https://nvd.nist.gov/vuln/detail/CVE-2023-3460
  classification: #tbd
    cvss-metrics: #tbd
    cvss-score: #tbd
    cve-id: CVE-2023-3460
    cwe-id: CWE-269
    cpe: #tbd
    epss-score: #tbd
  tags: cve,wp-plugin,unauth,wpscan,cve2021,wordpress
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - '{{BaseURL}}/wp-content/plugins/ultimate-member/readme.txt'

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

      - type: regex
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "Ultimate Member"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 2.6.7')