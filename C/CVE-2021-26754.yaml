id: CVE-2021-26754

info:
  name: wpDataTables < 3.4.1 - Unauthenticated SQL Injection
  author: akincibor
  severity: critical
  description: In the default configuration, a simple table can be published in a page that does not require authentication. The table can be searched, and is vulnerable to SQL Injection via the order parameter. An unauthenticated user visiting the page where the table is published can perform a SQL injection attack in the table search parameter order[0][dir].
  reference:
    - https://wpscan.com/vulnerability/bfd0cfd9-0d6a-47bb-9d73-762ddc138129
  tags: cve,cve2021,sqli,wp,wordpress,wp-plugin,unauth

requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-content/plugins/wpdatatables/readme.txt'

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

      - type: regex
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wpDataTables"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.4.1')