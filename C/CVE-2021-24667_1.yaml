id: CVE-2021-24667

info:
  name: >
    Gallery Blocks with Lightbox <= 2.2.0 - Authenticated Stored Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    A stored cross-site scripting vulnerability has been discovered in : Simply Gallery Blocks with Lightbox (Version â€“ 2.2.0 & below). The vulnerability exists in the Lightbox functionality where a user with low privileges is allowed to execute arbitrary script code within the context of the application. This vulnerability is due to insufficient validation of image parameters in meta data.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/5de488a2-72d6-4eeb-9b92-7f5bea1ee4ff?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-24667
  metadata:
    fofa-query: "wp-content/plugins/simply-gallery-block/"
    google-query: inurl:"/wp-content/plugins/simply-gallery-block/"
    shodan-query: 'vuln:CVE-2021-24667'
  tags: cve,wordpress,wp-plugin,simply-gallery-block,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/simply-gallery-block/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "simply-gallery-block"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.2.1')