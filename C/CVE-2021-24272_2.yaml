id: CVE-2021-24272

info:
  name: "Fitness Calculators <= 1.9.5 - Cross-Site Request Forgery to Stored Cross-Site Scripting"
  author: topscoder
  severity: medium
  description: "The fitness calculators WordPress plugin before 1.9.6 add calculators for Water intake, BMI calculator, protein Intake, and Body Fat and was lacking CSRF check, allowing attackers to make logged in users perform unwanted actions, such as change the calculator headers. Due to the lack of sanitisation, this could also lead to a Stored Cross-Site Scripting issue"
  reference:
    - https://wpscan.com/vulnerability/e643040b-1f3b-4c13-8a20-acfd069dcc4f
    - https://web.archive.org/web/20211206213710/https%3A//packetstormsecurity.com/files/164261/WordPress-Fitness-Calculators-1.9.5-Cross-Site-Request-Forgery.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-24272
  metadata:
    fofa-query: "wp-content/plugins/fitness-calculators/"
    google-query: inurl:"/wp-content/plugins/fitness-calculators/"
    shodan-query: 'vuln:CVE-2021-24272'
  tags: cve,wordpress,wp-plugin,fitness-calculators,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/fitness-calculators/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "fitness-calculators"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.9.5')