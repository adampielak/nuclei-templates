id: CVE-2021-25031

info:
  name: >
    Image Hover Effects Ultimate <= 9.7.0 - Reflected Cross-Site Scripting via effects
  author: topscoder
  severity: medium
  description: >
    The Image Hover Effects Ultimate (Image Gallery, Effects, Lightbox, Comparison or Magnifier) WordPress plugin before 9.7.1 does not escape the effects parameter before outputting it back in an attribute in an admin page, leading to a Reflected Cross-Site Scripting
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/4d902dfe-f16d-4795-9fcf-ee454b3d8c56?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-25031
  metadata:
    fofa-query: "wp-content/plugins/image-hover-effects-ultimate/"
    google-query: inurl:"/wp-content/plugins/image-hover-effects-ultimate/"
    shodan-query: 'vuln:CVE-2021-25031'
  tags: cve,wordpress,wp-plugin,image-hover-effects-ultimate,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/image-hover-effects-ultimate/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "image-hover-effects-ultimate"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 9.7.0')