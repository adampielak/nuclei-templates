id: CVE-2022-2222

info:
  name: "Download Monitor <= 4.5.9 - Authenticated Arbitrary File Download"
  author: topscoder
  severity: medium
  description: "The Download Monitor WordPress plugin before 4.5.91 does not ensure that files to be downloaded are inside the blog folders, and not sensitive, allowing high privilege users such as admin to download the wp-config.php or /etc/passwd even in an hardened environment or multisite setup."
  reference:
    - https://wpscan.com/vulnerability/dd48624a-1781-419c-a3c4-1e3eaf5e2c1b
    - https://patchstack.com/database/vulnerability/download-monitor-/wordpress-download-monitor-plugin-4-5-9-authenticated-arbitrary-file-download-vulnerability
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 4.9
    cve-id: CVE-2022-2222
  metadata:
    fofa-query: "wp-content/plugins/download-monitor/"
    google-query: inurl:"/wp-content/plugins/download-monitor/"
    shodan-query: 'vuln:CVE-2022-2222'
  tags: cve,wordpress,wp-plugin,download-monitor,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/download-monitor/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "download-monitor"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 4.5.9')