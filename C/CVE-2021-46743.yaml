id: CVE-2021-46743

info:
  name: "Firebase PHP-JWT < 6.0.0 - Algorithm Confusion"
  author: topscoder
  severity: low
  description: "In Firebase PHP-JWT before 6.0.0, an algorithm-confusion issue (e.g., RS256 / HS256) exists via the kid (aka Key ID) header, when multiple types of keys are loaded in a key ring. This allows an attacker to forge tokens that validate under the incorrect key. This may or may not be exploitable in WordPress plugins and themes using the library."
  reference:

  classification:
    cvss-metrics:
    cvss-score:
    cve-id: CVE-2021-46743
  metadata:
    fofa-query: "wp-content/plugins/jwt-auth/"
    google-query: inurl:"/wp-content/plugins/jwt-auth/"
    shodan-query: 'vuln:CVE-2021-46743'
  tags: cve,wordpress,wp-plugin,jwt-auth,low

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/jwt-auth/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "jwt-auth"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<=  2.1.0')