id: CVE-2022-2594-8c00fee918178b0f295d27c2a51549cd

info:
  name: >
    Advanced Custom Fields <= 5.12.2 - File Upload
  author: topscoder
  severity: medium
  description: >
    The Advanced Custom Fields plugin for WordPress has a file upload vulnerability in versions up to, and including, 5.12.2. This allows users without the upload_files capability, such as contributors, or unauthenticated users in cases where a frontend form is added to the site, to upload allowed file types. The upload is handled by WordPress so file type and extension checks still occur, though this could potentially be used by high-privileged users in certain locked-down configurations to bypass other security mechanisms and upload dangerous file types.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/e5bab390-1590-44f2-8c65-bc329955ed84?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-2594
  metadata:
    fofa-query: "wp-content/plugins/advanced-custom-fields/"
    google-query: inurl:"/wp-content/plugins/advanced-custom-fields/"
    shodan-query: 'vuln:CVE-2022-2594'
  tags: cve,wordpress,wp-plugin,advanced-custom-fields,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/advanced-custom-fields/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "advanced-custom-fields"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 5.12.2')