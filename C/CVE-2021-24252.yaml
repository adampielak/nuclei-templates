id: CVE-2021-24252

info:
  name: "Event Banner <= 1.3 - Cross-Site Request Forgery"
  author: topscoder
  severity: high
  description: "The Event Banner WordPress plugin through 1.3 does not verify the uploaded image file, allowing admin accounts to upload arbitrary files, such as .exe, .php, or others executable, leading to RCE. Due to the lack of CSRF check, the issue can also be used via such vector to achieve the same result, or via a LFI as authorisation checks are missing (but would require WP to be loaded)"
  reference:
    - https://wpscan.com/vulnerability/91e81c6d-f24d-4f87-bc13-746715af8f7c
    - https://web.archive.org/web/20210510214746/github.com/jinhuang1102/CVE-ID-Reports/blob/master/Event%20Banner.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2021-24252
  metadata:
    fofa-query: "wp-content/plugins/free-event-banner/"
    google-query: inurl:"/wp-content/plugins/free-event-banner/"
    shodan-query: 'vuln:CVE-2021-24252'
  tags: cve,wordpress,wp-plugin,free-event-banner,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/free-event-banner/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "free-event-banner"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.3')