id: CVE-2025-9242-version

info:
  name: WatchGuard Firebox - Remote Code Execution
  severity: critical
  author: darses
  description: |
    An Out-of-bounds Write vulnerability in the WatchGuard Fireware OS iked process may allow a remote unauthenticated attacker to execute arbitrary code. This vulnerability affects both the mobile user VPN with IKEv2 and the branch office VPN using IKEv2 when configured with a dynamic gateway peer. If the Firebox was previously configured with the mobile user VPN with IKEv2 or a branch office VPN using IKEv2 to a dynamic gateway peer, and both of those configurations have since been deleted, that Firebox may still be vulnerable if a branch office VPN to a static gateway peer is still configured.
  impact: |
    Remote unauthenticated attackers can execute arbitrary code, potentially leading to full system compromise.
  remediation: |
    Update to the latest Fireware OS version beyond 2025.1.1, 12.11.4, 12.5.13 or 12.3.1_Update3.
  classification:
    cve-id: CVE-2025-9242
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    cvss-score: 9.3
    cwe-id: CWE-787
  metadata:
    verified: false
    max-requests: 1
    vendor: watchguard
    product: firebox
    shodan-query:
      - http.html:"Firebox-DB"
      - http.favicon.hash:-569941107
    fofa-query:
      - icon_hash="-569941107"
    censys-query:
      - "services.software.product: `Fireware` and services.service_name=`IKE`"
  reference:
    - https://www.watchguard.com/wgrd-psirt/advisory/wgsa-2025-00015
  tags: cve,cve2025,watchguard

http:
  - method: GET
    path:
      - "{{BaseURL}}/images/favicon.ico"

    extractors:
      - type: kval
        part: header
        kval:
          - last_modified
        name: last_modified_str
        internal: true

      - type: dsl
        name: unix_timestamp
        dsl:
          - 'to_unix_time(last_modified_str, "Mon, 02 Jan 2006 15:04:05 GMT")'

    matchers:
      - type: dsl
        dsl:
          - status_code==200
          - sha256(body)=="9560bc07784890efa36dc4636b6d5f091059914bb5cb8941d00c5b47646efb8c"
          - to_number(unix_timestamp) < to_number(to_unix_time('2025-08-28'))
        condition: and
