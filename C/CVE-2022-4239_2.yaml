id: CVE-2022-4239

info:
  name: "Workreap <= 2.6.3 - Insecure Direct Object Reference"
  author: topscoder
  severity: medium
  description: "The Workreap theme for WordPress is vulnerable to insecure direct object reference in versions up to, and including, 2.6.3. This is due to missing validation on if an addon service belongs to an individual making a request to the workreap_addons_service_remove action. This makes it possible for authenticated attackers to call arbitrary addon services and delete posts."
  reference:
    - https://wpscan.com/vulnerability/1c163987-fb53-43f7-bbff-1c2d8c0d694c
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    cvss-score: 5.4
    cve-id: CVE-2022-4239
  metadata:
    fofa-query: "wp-content/themes/workreap/"
    google-query: inurl:"/wp-content/themes/workreap/"
    shodan-query: 'vuln:CVE-2022-4239'
  tags: cve,wordpress,wp-theme,workreap,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/themes/workreap/style.css"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Version: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Version: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "workreap"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.6.3')