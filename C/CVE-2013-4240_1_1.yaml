id: CVE-2013-4240

info:
  name: >
    HMS Testimonials <= 2.0.10 - Cross-Site Request Forgery
  author: topscoder
  severity: high
  description: >
    Multiple cross-site request forgery (CSRF) vulnerabilities in the HMS Testimonials plugin before 2.0.11 for WordPress allow remote attackers to hijack the authentication of administrators for requests that (1) add new testimonials via the hms-testimonials-addnew page, (2) add new groups via the hms-testimonials-addnewgroup page, (3) change default settings via the hms-testimonials-settings page, (4) change advanced settings via the hms-testimonials-settings-advanced page, (5) change custom fields settings via the hms-testimonials-settings-fields page, or (6) change template settings via the hms-testimonials-templates-new page to wp-admin/admin.php.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/0406b7a0-517d-4462-9b65-d4f708cf364d?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N
    cvss-score: 7.1
    cve-id: CVE-2013-4240
  metadata:
    fofa-query: "wp-content/plugins/hms-testimonials/"
    google-query: inurl:"/wp-content/plugins/hms-testimonials/"
    shodan-query: 'vuln:CVE-2013-4240'
  tags: cve,wordpress,wp-plugin,hms-testimonials,high

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/hms-testimonials/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "hms-testimonials"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.0.11')