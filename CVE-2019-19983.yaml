id: CVE-2019-19983

info:
  name: "Fast Velocity Minify <= 2.7.6 - Full Path Disclosure"
  author: topscoder
  severity: medium
  description: "In the WordPress plugin, Fast Velocity Minify before 2.7.7, the full web root path to the running WordPress application can be discovered. In order to exploit this vulnerability, FVM Debug Mode needs to be enabled and an admin-ajax request needs to call the fastvelocity_min_files action."
  reference:
    - https://wpvulndb.com/vulnerabilities/9914
    - https://www.wordfence.com/blog/2019/10/medium-severity-vulnerability-patched-in-fast-velocity-minify-plugin/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cve-id: CVE-2019-19983
  metadata:
    fofa-query: "wp-content/plugins/fast-velocity-minify/"
    google-query: inurl:"/wp-content/plugins/fast-velocity-minify/"
    shodan-query: 'vuln:CVE-2019-19983'
  tags: cve,wordpress,wp-plugin,fast-velocity-minify,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/fast-velocity-minify/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "fast-velocity-minify"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.7.6')