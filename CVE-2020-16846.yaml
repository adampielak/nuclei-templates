id: CVE-2020-16846

info:
<<<<<<< HEAD
  name: SaltStack Shell Injection
  author: dwisiswant0
  severity: critical
  description: |
    SaltStack Salt through 3002. Sending crafted web requests to the Salt API,
    with the SSH client enabled, can result in shell injection.

    This template supports the detection part only. See references.
  reference: |
    - https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag
    - https://github.com/vulhub/vulhub/tree/master/saltstack/CVE-2020-16846
  tags: cve,cve2020,saltstack
<<<<<<< HEAD
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.80
    cve-id: CVE-2020-16846
    cwe-id: CWE-78
=======
  name: SaltStack <=3002 - Shell Injection
  author: dwisiswant0
  severity: critical
  description: SaltStack Salt through 3002 allows an unauthenticated user with network access to the Salt API to use shell injections to run code on the Salt-API using the SSH client.
  reference:
    - https://saltproject.io/on-november-3-2020-saltstack-publicly-disclosed-three-new-cves/
    - https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag
    - https://github.com/vulhub/vulhub/tree/master/saltstack/CVE-2020-16846
    - https://nvd.nist.gov/vuln/detail/CVE-2020-16846
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-16846
    cwe-id: CWE-78
  tags: vulhub,cve,cve2020,saltstack,kev
>>>>>>> 5d36d276 (add new stuff)
=======
>>>>>>> 18ddf72b (add new stuff)

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        POST /run HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
        Content-Type: application/x-www-form-urlencoded

        token=1337&client=ssh&tgt=*&fun=a&roster=projectdiscovery&ssh_priv=nuclei
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500
      - type: word
        words:
          - "application/json"
        part: header
      - type: word
        words:
          - "An unexpected error occurred"
<<<<<<< HEAD
        part: body
=======
        part: body

# Enhanced by mp on 2022/04/27
>>>>>>> 5d36d276 (add new stuff)
