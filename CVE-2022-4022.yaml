id: CVE-2022-4022

info:
  name: "SVG Support 2.5 - 2.5.1 - Insecure Plugin Defaults to Cross-Site Scripting"
  author: topscoder
  severity: medium
  description: "The SVG Support plugin for WordPress defaults to insecure settings in version 2.5 and 2.5.1. SVG files containing malicious javascript are not sanitized. While version 2.5 adds the ability to sanitize image as they are uploaded, the plugin defaults to disable sanitization and does not restrict SVG upload to only administrators. This allows authenticated attackers, with author-level privileges and higher, to upload malicious SVG files that can be embedded in posts and pages by higher privileged users. Additionally, the embedded JavaScript is also triggered on visiting the image URL, which allows an attacker to execute malicious code in browsers visiting that URL."
  reference:
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2776612%40svg-support%2Ftrunk&old=2672900%40svg-support%2Ftrunk&sfp_email=&sfph_mail=
    - https://www.wordfence.com/vulnerability-advisories-continued/#CVE-2022-4022
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
    cve-id: CVE-2022-4022
  metadata:
    fofa-query: "wp-content/plugins/svg-support/"
    google-query: inurl:"/wp-content/plugins/svg-support/"
    shodan-query: 'vuln:CVE-2022-4022'
  tags: cve,wordpress,wp-plugin,svg-support,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/svg-support/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "svg-support"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '>= 2.5', '<= 2.5')